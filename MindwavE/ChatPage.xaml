<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MindwavE.ChatPage"
             Title="MindBot"
             BackgroundColor="#F5F5F5">
    <Grid RowDefinitions="Auto,*,Auto,Auto">
        <!-- Header -->
        <Label Grid.Row="0"
               Text="MindBot"
               FontSize="28"
               FontAttributes="Bold"
               FontFamily="NunitoSans"
               HorizontalOptions="Center"
               Padding="0,15,0,15"
               TextColor="#333333" />

        <!-- Chat messages -->
        <CollectionView Grid.Row="1"
                        x:Name="ChatMessagesView"
                        ItemsSource="{Binding Messages}"
                        Margin="20,0"
                        VerticalOptions="FillAndExpand">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Border 
                        StrokeThickness="0"
                        StrokeShape="RoundRectangle 10"
                        Background="White"
                        Padding="10"
                        Margin="10"
                        HorizontalOptions="FillAndExpand"
                        MaximumWidthRequest="800">
                        <Label Text="{Binding Content}" TextColor="#333" LineBreakMode="WordWrap" />
                    </Border>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <!-- Typing Indicator -->
        <StackLayout Grid.Row="2" 
                     x:Name="TypingIndicatorLayout" 
                     Orientation="Horizontal" 
                     Padding="20,5" 
                     Spacing="10" 
                     IsVisible="False">
            <ActivityIndicator IsRunning="True" Color="#333" HeightRequest="20" WidthRequest="20" />
            <Label Text="AI is typing..." TextColor="Gray" VerticalOptions="Center" FontFamily="NunitoSans_Italic" />
        </StackLayout>

        <!-- Input field & send button -->
        <StackLayout Grid.Row="3" Orientation="Horizontal" Padding="20,10,20,10" Spacing="10">
            <Border
                Grid.Column="0"
                StrokeThickness="0"
                StrokeShape="RoundRectangle 40"
                Background="White"
                Padding="10,10"
                Margin="0,0,10,0"
                HorizontalOptions="FillAndExpand"
                MaximumWidthRequest="750"
                >

                <Border.Shadow>
                    <Shadow
                        Opacity="0.1"
                        Radius="3"
                        Offset="0,7"
                        Brush="Black" />
                </Border.Shadow>

                <Entry x:Name="MessageEntry"
                   Placeholder="Unesi poruku..."
                   HorizontalOptions="Fill"
                   FontSize="16"
                   FontFamily="NunitoSans_Italic"
                   TextColor="Black"
                   
                   />
            </Border>
            <Button 
                Text="PoÅ¡alji" 
                Clicked="OnSendClicked"
                x:Name="SendButton" 
                FontFamily="NunitoSans"
                FontSize="20"
                CornerRadius="30"
                FontAttributes="Bold"
                WidthRequest="100"
                >
                <Button.Shadow>
                    <Shadow
                    Opacity="0.1"
                    Radius="3"
                    Offset="0,7"
                    Brush="Black" />
                </Button.Shadow>
            </Button>
        </StackLayout>
    </Grid>
</ContentPage>